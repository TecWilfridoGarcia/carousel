<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<style>
  *,
  *:before,
  *:after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    height: 74px;
    width: 100%;
  }

  .carousel {
    position: relative;
    width: 94%;
    height: 100%;
    margin: 0 auto;
    margin-top: 30px;

  }

  .carousel-content {
    position: relative;
    overflow: hidden;
    transition: width .4s;
    height: 100%;
  }

.carousel-content::before {
  content: "";
    filter: blur(5px);
    position: absolute;
    color: black;
    z-index: 28;
    width: 26px;
    right: -9px;
    background: white;
    top: -10px;
    height: 112px;
    opacity: .7;
}
  .slide {
    height: 100%;
    position: absolute;
    z-index: 1;
    transition: left .4s cubic-bezier(.47, .13, .15, .89);
    width: 74px !important;
    height: 74px !important;
    border-radius: 12px;
  }

  .slide-1 {
    background-color: blue;
  }

  .slide-2 {
    background-color: green;

  }

  .slide-3 {
    background-color: red;
  }

  .slide-4 {
    background-color: purple;
  }

  .slide-5 {
    background-color: yellow;
  }

  .nav {
    position: absolute;
    top: 50%;
    margin-top: -10px;
    background-color: rgb(58, 40, 40);
    width: 20px;
    height: 20px;
    z-index: 2;
    cursor: pointer;
    border-radius: 50%;
    border: none;
    outline: none;
    color: white;
    -webkit-user-select: none;
  }

  .nav-left {
    left: -25px;
    left: 2%;
  }

  .nav-right {
    right: -25px;
    left: 86%;
  }

  .carousel-arrow-icon-left {
    margin-left: 5px;
    margin-top: 2px;
  }

  .carousel-arrow-icon-right {
    margin-left: 7px;
    margin-top: 2px;
  }

  .text-slider {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  header {
    width: 100%;
    height: 46px;
    color: white;
    background-color: #dd141d;
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>

<body>
  <header>this is a header</header>
  <div class="container">

    <div class="carousel">
      <div class="nav nav-left">
        <div class="ion-chevron-left carousel-arrow-icon-left"> < </div>
      </div>

      <div class="carousel-content">

        <div class="slide slide-1">
          <div class="text-slider">cat</div>
        </div>
        <div class="slide slide-2">
          <div class="text-slider">dog</div>
        </div>
        <div class="slide slide-3">
          <div class="text-slider">mouse</div>
        </div>
        <div class="slide slide-4">
          <div class="text-slider">hen</div>
        </div>
        <div class="slide slide-5">
          <div class="text-slider">bug</div>
        </div>

      </div>

      <div class="nav nav-right">
        <div class="ion-chevron-right carousel-arrow-icon-right"> > </div>
      </div>
    </div>

  </div>

  <script>
    var carousel = document.querySelector('.carousel');
    var carouselContent = document.querySelector('.carousel-content');
    var slides = document.querySelectorAll('.slide');
    var arrayOfSlides = Array.prototype.slice.call(slides);
    var carouselDisplaying;
    var screenSize;
    setScreenSize();
    var lengthOfSlide;

    function addClone() {
      var lastSlide = carouselContent.lastElementChild.cloneNode(true);
      lastSlide.style.left = (-lengthOfSlide - 30) + "px";
      carouselContent.insertBefore(lastSlide, carouselContent.firstChild);
      console.log('addClone');
    }
    // addClone();

    function removeClone() {
      var firstSlide = carouselContent.firstElementChild;
      firstSlide.parentNode.removeChild(firstSlide);
      console.log('removeClone');
    }

    function moveSlidesRight() {
      var slides = document.querySelectorAll('.slide');
      var slidesArray = Array.prototype.slice.call(slides);
      var width = 0;
      slidesArray.forEach(function (el, i) {
        el.style.left = width + "px";
        width += lengthOfSlide;
      });
      addClone();
      console.log('moveSlidesRight');
    }
    moveSlidesRight();
    function moveSlidesLeft() {
      var slides = document.querySelectorAll('.slide');
      var slidesArray = Array.prototype.slice.call(slides);
      slidesArray = slidesArray.reverse();
      var maxWidth = (slidesArray.length - 1) * lengthOfSlide;

      slidesArray.forEach(function (el, i) {
        maxWidth -= lengthOfSlide;
        el.style.left = maxWidth + "px";
      });
      console.log('moveSlidesLeft');
    }

    window.addEventListener('resize', setScreenSize);

    function setScreenSize() {
      if (window.innerWidth >= 200) {
        carouselDisplaying = 3.5;
      } else if (window.innerWidth >= 300) {
        carouselDisplaying = 2;
      } else {
        carouselDisplaying = 1;
      }
      getScreenSize();
      console.log('setScreenSize');
    }
    function getScreenSize() {
      var slides = document.querySelectorAll('.slide');
      var slidesArray = Array.prototype.slice.call(slides);
      lengthOfSlide = (carousel.offsetWidth / carouselDisplaying);
      var initialWidth = -lengthOfSlide;
      slidesArray.forEach(function (el) {
        el.style.width = lengthOfSlide + "px";
        el.style.left = initialWidth + "px";
        initialWidth += lengthOfSlide;
      });
    }

    var rightNav = document.querySelector('.nav-right');
    rightNav.addEventListener('click', moveLeft);

    var moving = true;
    function moveRight() {
      if (moving) {
        moving = false;
        var lastSlide = carouselContent.lastElementChild;
        lastSlide.parentNode.removeChild(lastSlide);
        carouselContent.insertBefore(lastSlide, carouselContent.firstChild);
        removeClone();
        var firstSlide = carouselContent.firstElementChild;
        firstSlide.addEventListener('transitionend', activateAgain);
        moveSlidesRight();
      }
    }

    function activateAgain() {
      var firstSlide = carouselContent.firstElementChild;
      moving = true;
      firstSlide.removeEventListener('transitionend', activateAgain);
    }

    var leftNav = document.querySelector('.nav-left');
    leftNav.addEventListener('click', moveRight);

    // var moveLeftAgain = true;

    function moveLeft() {
      if (moving) {
        moving = false;
        removeClone();
        var firstSlide = carouselContent.firstElementChild;
        firstSlide.addEventListener('transitionend', replaceToEnd);
        moveSlidesLeft();
      }
    }

    function replaceToEnd() {
      var firstSlide = carouselContent.firstElementChild;
      firstSlide.parentNode.removeChild(firstSlide);
      carouselContent.appendChild(firstSlide);
      firstSlide.style.left = ((arrayOfSlides.length - 1) * lengthOfSlide) + "px";
      addClone();
      moving = true;
      firstSlide.removeEventListener('transitionend', replaceToEnd);
    }




    carouselContent.addEventListener('mousedown', seeMovement);

    var initialX;
    var initialPos;
    function seeMovement(e) {
      initialX = e.clientX;
      getInitialPos();
      carouselContent.addEventListener('mousemove', slightMove);
      document.addEventListener('mouseup', moveBasedOnMouse);
    }

    function slightMove(e) {
      if (moving) {
        var movingX = e.clientX;
        var difference = initialX - movingX;
        if (Math.abs(difference) < (lengthOfSlide / 3)) {
          slightMoveSlides(difference);
        }
      }
    }

    function getInitialPos() {
      var slides = document.querySelectorAll('.slide');
      var slidesArray = Array.prototype.slice.call(slides);
      initialPos = [];
      slidesArray.forEach(function (el) {
        var left = Math.floor(parseInt(el.style.left.slice(0, -2)));
        initialPos.push(left);
      });
    }

    function slightMoveSlides(newX) {
      var slides = document.querySelectorAll('.slide');
      var slidesArray = Array.prototype.slice.call(slides);
      slidesArray.forEach(function (el, i) {
        var oldLeft = initialPos[i];
        el.style.left = (oldLeft + newX) + "px";
      });
    }

    function moveBasedOnMouse(e) {
      var finalX = e.clientX;
      if (initialX - finalX > 0) {
        moveRight();
      } else if (initialX - finalX < 0) {
        moveLeft();
      }
      document.removeEventListener('mouseup', moveBasedOnMouse);
      carouselContent.removeEventListener('mousemove', slightMove);
    }
  </script>
</body>

</html>